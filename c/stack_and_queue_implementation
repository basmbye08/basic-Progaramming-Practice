#include<stdio.h>
#define MAX 5

int stack[MAX], top=-1;
int queue[MAX], front=-1, rear=-1;
int cqueue[MAX], cfront=-1, crear=-1;

void push(int val) {
    if(top==MAX-1) printf("Stack Overflow\n");
    else stack[++top]=val;
}

int pop() {
    if(top==-1) {
        printf("Stack Underflow\n");
        return -1;
    }
    return stack[top--];
}

void displayStack() {
    if(top==-1) printf("Stack empty\n");
    else {
        for(int i=top; i>=0; i--)
            printf("%d\n", stack[i]);
    }
}

void enqueue(int val) {
    if(rear==MAX-1) printf("Queue Overflow\n");
    else {
        if(front==-1) front=0;
        queue[++rear]=val;
    }
}

int dequeue() {
    if(front==-1 || front>rear) {
        printf("Queue Underflow\n");
        return -1;
    }
    return queue[front++];
}

void displayQueue() {
    if(front==-1 || front>rear) printf("Queue empty\n");
    else {
        for(int i=front; i<=rear; i++)
            printf("%d ", queue[i]);
        printf("\n");
    }
}

void cenqueue(int val) {
    if((crear+1)%MAX==cfront) printf("Circular Queue Overflow\n");
    else {
        if(cfront==-1) cfront=0;
        crear=(crear+1)%MAX;
        cqueue[crear]=val;
    }
}

int cdequeue() {
    if(cfront==-1) {
        printf("Circular Queue Underflow\n");
        return -1;
    }
    int val=cqueue[cfront];
    if(cfront==crear) cfront=crear=-1;
    else cfront=(cfront+1)%MAX;
    return val;
}

void displayCQueue() {
    if(cfront==-1) printf("Circular Queue empty\n");
    else {
        int i=cfront;
        while(1) {
            printf("%d ", cqueue[i]);
            if(i==crear) break;
            i=(i+1)%MAX;
        }
        printf("\n");
    }
}

int main() {
    int ch, val, ds;
    while(1) {
        printf("1.Stack 2.Queue 3.Circular Queue 4.Exit: ");
        scanf("%d", &ds);
        if(ds==1) {
            while(1) {
                printf("1.Push 2.Pop 3.Display 4.Back: ");
                scanf("%d", &ch);
                if(ch==1) {
                    printf("Value: ");
                    scanf("%d", &val);
                    push(val);
                }
                else if(ch==2) printf("Popped: %d\n", pop());
                else if(ch==3) displayStack();
                else break;
            }
        }
        else if(ds==2) {
            while(1) {
                printf("1.Enqueue 2.Dequeue 3.Display 4.Back: ");
                scanf("%d", &ch);
                if(ch==1) {
                    printf("Value: ");
                    scanf("%d", &val);
                    enqueue(val);
                }
                else if(ch==2) printf("Dequeued: %d\n", dequeue());
                else if(ch==3) displayQueue();
                else break;
            }
        }
        else if(ds==3) {
            while(1) {
                printf("1.Enqueue 2.Dequeue 3.Display 4.Back: ");
                scanf("%d", &ch);
                if(ch==1) {
                    printf("Value: ");
                    scanf("%d", &val);
                    cenqueue(val);
                }
                else if(ch==2) printf("Dequeued: %d\n", cdequeue());
                else if(ch==3) displayCQueue();
                else break;
            }
        }
        else break;
    }
    return 0;
}
